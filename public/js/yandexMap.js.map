{"version":3,"names":[],"mappings":"","sources":["yandexMap.js"],"sourcesContent":["\r\n//var Location;\r\n// карта\r\nvar map;\r\n// массив с координатами и id маркеров\r\nvar points = [];\r\n// коллекция с маркерами карты\r\nvar ObjectsPoints = [];\r\nvar markersCollection;\r\n// стили для маркеров карты\r\nvar markerStyle = {\r\n    iconLayout: 'default#imageWithContent',\r\n    iconImageHref: yandexMap_config.iconImageHref,\r\n    iconImageSize: yandexMap_config.iconImageSize,\r\n    iconImageOffset: yandexMap_config.iconImageOffset\r\n};\r\n\r\n// инициализация карты\r\nfunction init() {\r\n    map = new ymaps.Map(\"GMap\", {\r\n        center: [55.76, 37.64],\r\n        zoom: 10\r\n    }, {\r\n        searchControlProvider: 'yandex#search'\r\n    });\r\n    // создание маркеров, на входи принимает ссылку на обект\r\n    markerInit(Location[Object.keys(Location)[0]]);\r\n}\r\n// конструктор обекта с координатами и id маркеров\r\nvar pointsConstruct = function (lat, lng, id) {\r\n    this.coords = [lat, lng];\r\n    this.id = id;\r\n};\r\n// создание маркеров\r\nfunction markerInit(locationOBJ) {\r\n    clearMarkers(); // метод очистки коллекции маркеров\r\n\r\n    city = locationOBJ, // переданный в функцию обект\r\n        store = city.stores, // список городов\r\n        markersCollection = new ymaps.ObjectManager({\r\n            clusterize: false\r\n        }); // создаем экземпляр гео коллекции, в ней будут хранится маркеры\r\n    // метод выставляет центр карты и делает зум\r\n    map.setCenter([city.center.lat, city.center.lng], 10, {\r\n        checkZoomRange: true\r\n    });\r\n\r\n    // заполняем массив с информацией о координатах и id маркеров\r\n    for (var i = 0; i < store.length; i++) {\r\n        points.push(new pointsConstruct(store[i].lat, store[i].lng, store[i].id));\r\n    }\r\n\r\n    // добавляем маркеры в гео коллекцию\r\n    for (var i = 0, l = points.length; i < l; i++) {\r\n        ObjectsPoints.push({\r\n            type: 'Feature',\r\n            id: points[i].id,\r\n            geometry: {\r\n                type: 'Point',\r\n                coordinates: points[i].coords\r\n            },\r\n            options: {\r\n                iconLayout: 'default#imageWithContent',\r\n                iconImageHref: yandexMap_config.iconImageHref,\r\n                iconImageSize: [36, 43],\r\n                iconImageOffset: [-20, -20]\r\n            },\r\n            properties: {\r\n                // Контент метки.\r\n                iconContent: \"<span class='yamap_point'>\" + points[i].id + \"</span\"\r\n            }\r\n        });\r\n    }\r\n\r\n    markersCollection.add(ObjectsPoints);\r\n    map.geoObjects.add(markersCollection);\r\n\r\n    // Функция вызываемая при наведении на маркер\r\n    function onObjectEvent(e) {\r\n        var objectId = e.get('objectId');\r\n        if (e.get('type') == 'mouseenter') {\r\n            changeMarker(objectId, \"hover\")\r\n            LocationItemHover(objectId);\r\n\r\n        } else {\r\n            changeMarker(objectId)\r\n            LocationItemOnHover(objectId);\r\n        }\r\n    }\r\n    // Обработчик события наведения на маркер\r\n    markersCollection.objects.events.add(['mouseenter', 'mouseleave'], onObjectEvent);\r\n\r\n\r\n}\r\n\r\n\r\nymaps.ready(init);\r\n\r\n\r\n\r\nfunction clearMarkers() {\r\n    if (markersCollection) {\r\n        markersCollection.remove(ObjectsPoints);\r\n        ObjectsPoints.splice(0, ObjectsPoints.length);\r\n        points.splice(0, points.length);\r\n    }\r\n}\r\n\r\nfunction changeMarker(objectId, status) {\r\n    clearMarker();\r\n    if (status == \"hover\") {\r\n        markersCollection.objects.setObjectOptions(objectId, {\r\n            iconImageHref: yandexMap_config.iconImageHoverHref\r\n        });\r\n    } else {\r\n        markersCollection.objects.setObjectOptions(objectId, {\r\n            iconImageHref: yandexMap_config.iconImageHref\r\n        });\r\n    }\r\n}\r\n\r\nfunction clearMarker() {\r\n    for (var i = 0; i < ObjectsPoints.length; i++)\r\n        markersCollection.objects.setObjectOptions(i + 1, {\r\n            iconImageHref: yandexMap_config.iconImageHref\r\n        });\r\n\r\n}\r\n$(\".location__tabs li a\").on(\"click\", function (event) {\r\n    event.preventDefault();\r\n    $(\".location__item\").removeClass(\"active\");\r\n    var $this = $($(this));\r\n    var link = $this.attr(\"href\");\r\n    if ($this.closest(\"li\").hasClass(\"active\")) {\r\n        return\r\n    }\r\n    $(\".location__tabs li\").removeClass(\"active\");\r\n    $this.closest(\"li\").addClass(\"active\");\r\n    $(\".location__list\").removeClass(\"active\");\r\n    $(link).addClass(\"active\");\r\n\r\n    link = link.substring(1);\r\n    markerInit(Location[link]);\r\n})\r\n\r\n\r\n\r\n\r\nvar hoverColor = \"#eaeaea\";\r\n\r\n\r\n$(\".location__item\").on(\"click\", function (event) {\r\n    var itemList = $(\".location__item\");\r\n\r\n    for (var i = 0; i < itemList.length; i++) {\r\n        $(itemList[i]).removeClass(\"active\");\r\n    }\r\n    if ($(this).hasClass(\"active\")) {\r\n        return\r\n    }\r\n    $(this).addClass(\"active\");\r\n\r\n    var objectId = parseInt($(this).find(\".location__title-num\").text(), 10);\r\n    clearMarker();\r\n    changeMarker(objectId, \"hover\");\r\n\r\n})\r\n\r\n$(\".location__item\").hover(LocationItemHover, LocationItemOnHover);\r\n\r\nfunction LocationItemHover(id) {\r\n\r\n    if ($(this).hasClass(\"active\")) {\r\n        return\r\n    }\r\n    $(\".location__item.active\").css({\r\n        \"background-color\": \"transparent\"\r\n    })\r\n    if ($(this).hasClass(\"location__item\")) {\r\n        $(this).css({\r\n            \"background-color\": hoverColor\r\n        })\r\n        var objectId = parseInt($(this).find(\".location__title-num\").text(), 10);\r\n        clearMarker();\r\n        changeMarker(objectId, \"hover\");\r\n    }\r\n    if (id) {\r\n        var arrayIdLocationItem = [];\r\n        var num = $(\".location__list.active\").find(\".location__item\");\r\n        for (var i = 0; i < num.length; i++) {\r\n            if (id == i + 1) {\r\n                $(num[i]).css({\r\n                    \"background-color\": hoverColor\r\n                })\r\n            }\r\n        }\r\n        return\r\n    }\r\n}\r\n\r\nfunction LocationItemOnHover(id) {\r\n    if ($(this).hasClass(\"active\")) {\r\n        return\r\n    }\r\n    $(\".location__item.active\").css({\r\n        \"background-color\": hoverColor\r\n    })\r\n    if ($(this).hasClass(\"location__item\")) {\r\n        $(this).css({\r\n            \"background-color\": \"transparent\"\r\n        })\r\n        clearMarker();\r\n        var objectId = parseInt($(\".location__item.active\").find(\".location__title-num\").text(), 10);\r\n        clearMarker();\r\n        changeMarker(objectId, \"hover\");\r\n    }\r\n    if (id) {\r\n        var num = $(\".location__list.active\").find(\".location__item\");\r\n        for (var i = 0; i < num.length; i++) {\r\n            if ($(num[i]).hasClass(\"active\")) {\r\n                clearMarker();\r\n                changeMarker(i + 1, \"hover\");\r\n            } else if (id == i + 1) {\r\n                $(num[i]).css({\r\n                    \"background-color\": \"transparent\"\r\n                })\r\n            }\r\n        }\r\n        return\r\n    }\r\n\r\n\r\n}\r\n"],"file":"yandexMap.js"}